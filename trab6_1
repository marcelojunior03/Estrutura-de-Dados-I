//Nome: Marcelo Heiffig Júnior - RA: CV3095126

#include <stdio.h>
#include <stdbool.h>
#include <string.h>

#define MAXVEN 20
#define MAXCLI 10
#define MAXATE 20

struct data{
    short int dia, mes, ano;
};
typedef struct data Data;

struct atendimento{
    char nomeVendedor[50];
    char nomeCliente[50];
    Data umaData;
    float nota;
};
typedef struct atendimento Atendimento;

void cadastrarClientes(char clientes[MAXCLI][50], int *quantos){
    char continua;

    do
    {
        fflush(stdin);
        printf("\nDigite o nome do cliente %i: ", *quantos+1);
        gets(clientes[*quantos]);
        *quantos = *quantos + 1;

        fflush(stdin);
        printf("\nCadastrar mais um cliente? (S/N) ");
        continua = getchar();
    }
    while(toupper(continua) == 'S' && *quantos < MAXCLI);
}

bool jaExisteVen(char nome[50], char vendedores[MAXVEN][50], int quantos){
    bool achou = false;

    for(int i = 0; i < quantos; i++){
        if(strcmp(nome, vendedores[i]) == 0){
            achou = true;
        }
    }
    return achou;
}

bool jaExisteCli(char nome[50], char clientes[MAXCLI][50], int quantos){
    bool achou = false;

    for(int i = 0; i < quantos; i++){
        if(strcmp(nome, vendedores[i]) == 0){
            achou = true;
        }
    }
    return achou;
}

void cadastrarVendedores(char vendedores[MAXVEN][50], int *quantos){
    char nome[50];
    char continua;

    do{
        do{
            fflush(stdin);
            printf("\nDigite o nome do vendedor: ");
            gets(nome);

            if(jaExisteVen(nome, vendedores, *quantos)){
                printf("\nO vendedor ja esta cadastrado!");
            }
        }
        while(jaExisteVen(nome, vendedores, *quantos));

        strcpy(vendedores[*quantos], nome);
        *quantos = *quantos + 1;

        fflush(stdin);
        printf("\nCadastrar mais um vendedor? (S/N) ");
        continua = getchar();
    }
    while(toupper(continua) == 'S' && *quantos < MAXVEN);
}

void cadastrarAtendimentos(Atendimento atendimentos[MAXATE], int *quantos, char clientes[MAXCLI][50], int quantosClientes, char vendedores[MAXVEN][50], int quantosVendedores){
    char nome[50];
    char continua;

    do{
        do{
            fflush(stdin);
            printf("\nDigite o nome do vendedor: ");
            gets(nome);

            if(jaExisteVen(nome, vendedores, *quantos) == false){
                printf("\nO vendedor nao existe!");
            }
        }
        while(jaExisteVen(nome, vendedores, *quantos) == false);

        strcpy(nome, atendimentos[*quantos].nomeVendedor);

        do{
            fflush(stdin);
            printf("\nDigite o nome do cliente: ");
            gets(nome);

            if(jaExisteCli(nome, clientes, *quantos) == false){
                printf("\nO cliente nao existe!");
            }
        }
        while(jaExisteCli(nome, clientes, *quantos) == false);

        strcpy(nome, atendimentos[*quantos].nomeCliente);



        *quantos = *quantos + 1;
        fflush(stdin);
        printf("\nCadastrar mais um atendimento? (S/N) ");
        continua = getchar();
    }
    while(toupper(continua) == 'S' && *quantos < MAXATE);
}

void main(){
    char clientes[MAXCLI][50];
    int quantosClientes = 0;
    char vendedores[MAXVEN][50];
    int quantosVendedores = 0;
    Atendimento atendimentos[MAXATE];
    int quantosAtendimentos = 0;

    ///cadastramento de clientes
    cadastrarClientes(clientes, &quantosClientes);

    cadastrarVendedores(vendedores, &quantosVendedores);

    cadastrarAtendimentos(atendimentos, &quantosAtendimentos, clientes, quantosClientes, vendedores, quantosVendedores);

    imprimirRelatorio(atendimentos, quantosAtendimentos);
}

/*Em ambos os exercícios, cada das uma das funcionalidades principais deverá ser acessada
a partir de um menu de opções. Obrigatoriamente deve-se propor a implementação do
programa com auxílio de funções e não é permitida a utilização de variáveis globais (e
nem break e continue para sair de loops).*/
